<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DermAI - Skin Analyzer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <i class="fa-solid fa-dna logo-icon"></i>
            <h1>DermAI</h1>
            <h2>DEEP LEARNING SKIN DIAGNOSTICS</h2>
        </header>
        <main>
            <form class="analysis-form" method="post" enctype="multipart/form-data">
                
                <div class="form-group">
                    <label for="file" class="upload-area-wrapper" id="upload-wrapper">
                        <i class="fa-solid fa-cloud-arrow-up upload-icon" id="upload-icon"></i>
                        <div class="upload-text-group">
                            <span class="custom-file-label">Click to Upload Clinical Image</span>
                            <span id="file-name" class="file-name">Supported formats: JPG, PNG</span>
                        </div>
                    </label>
                    <input type="file" name="file" id="file" accept="image/*" style="display:none;" required>

                    <div id="quality-feedback" class="quality-feedback-box">
                        <p class="quality-info"><i class="fa-solid fa-circle-info"></i> Image analysis begins after a file is selected.</p>
                    </div>
                </div>

                <div class="form-group">
                    <label for="language" style="font-weight: 600; display: block; margin-bottom: 8px; color: #495057;">Analysis Language</label>
                    <select name="language" id="language">
                        <option value="en">English (Standard)</option>
                        <option value="es">Español</option>
                        <option value="fr">Français</option>
                    </select>
                </div>

                <button type="submit" class="submit-btn" id="submit-btn" disabled>
                    Run Analysis <i class="fa-solid fa-microscope" style="margin-left: 5px;"></i>
                </button>
            </form>
        </main>
        <footer>
            <p class="disclaimer">
                ⚠️ **Research Prototype:** Results are generated by a CNN model. Consult a dermatologist.
            </p>
        </footer>
    </div>
    <script>
        const fileInput = document.getElementById('file');
        const fileNameDisplay = document.getElementById('file-name');
        const wrapper = document.getElementById('upload-wrapper');
        const icon = document.getElementById('upload-icon');
        const feedbackBox = document.getElementById('quality-feedback');
        const submitBtn = document.getElementById('submit-btn');

        fileInput.addEventListener('change', function() {
            if (this.files && this.files.length > 0) {
                const fileName = this.files[0].name;
                fileNameDisplay.textContent = "Selected: " + fileName;
                
                // Simulate Quality Check (Random result for demonstration)
                const isGoodQuality = Math.random() > 0.3; // 70% chance of success

                if (isGoodQuality) {
                    // Success State
                    wrapper.style.borderColor = "#28a745"; 
                    wrapper.style.background = "#e6ffe6";
                    icon.className = "fa-solid fa-circle-check upload-icon";
                    icon.style.color = "#28a745";
                    feedbackBox.innerHTML = '<p class="quality-ok"><i class="fa-solid fa-check-circle"></i> Image quality acceptable. Ready to analyze.</p>';
                    submitBtn.disabled = false;
                } else {
                    // Warning/Poor Quality State
                    wrapper.style.borderColor = "#ffc107"; 
                    wrapper.style.background = "#fff8e0";
                    icon.className = "fa-solid fa-triangle-exclamation upload-icon";
                    icon.style.color = "#ffc107";
                    feedbackBox.innerHTML = '<p class="quality-alert"><i class="fa-solid fa-exclamation-triangle"></i> Warning: Low sharpness/lighting detected. Results may be inaccurate. Try a clearer photo.</p>';
                    submitBtn.disabled = false; // Still allow submission, but warn user
                }
            } else {
                // Reset State
                fileNameDisplay.textContent = 'Supported formats: JPG, PNG';
                wrapper.style.borderColor = "#ced4da";
                wrapper.style.background = "#f8f9fa";
                icon.className = "fa-solid fa-cloud-arrow-up upload-icon";
                icon.style.color = "#007bff";
                feedbackBox.innerHTML = '<p class="quality-info"><i class="fa-solid fa-circle-info"></i> Image analysis begins after a file is selected.</p>';
                submitBtn.disabled = true;
            }
        });
    </script>
</body>
</html>